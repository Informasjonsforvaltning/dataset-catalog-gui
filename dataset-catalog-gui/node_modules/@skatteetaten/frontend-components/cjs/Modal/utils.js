"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useEscOnPress = exports.getSkeBasisStylingWrapper = exports.getModalAnchor = exports.createModalDomPlacement = void 0;

var _react = require("react");

const getModalAnchor = shadowRootNode => {
  const modalAnchorInShadowDom = shadowRootNode?.getElementById('modal-wrapper');
  const modalAnchorInLightDom = document.getElementById('modal-wrapper');
  return modalAnchorInShadowDom ?? modalAnchorInLightDom ?? document.body;
};

exports.getModalAnchor = getModalAnchor;

const getSkeBasisStylingWrapper = rootNode => {
  let ltrWrapper;
  const ltrDomElements = rootNode.querySelectorAll('[dir="ltr"]');

  for (let i = 0; i < ltrDomElements.length; i++) {
    if (ltrDomElements[i].className.includes('body-')) {
      ltrWrapper = ltrDomElements[i];
    }
  }

  return ltrWrapper;
};

exports.getSkeBasisStylingWrapper = getSkeBasisStylingWrapper;

const createModalDomPlacement = (setFlag, shadowRootNode) => {
  const modalAnchorId = 'modal-wrapper';
  const rootNode = shadowRootNode ?? document;

  if (rootNode.getElementById(modalAnchorId)) {
    setFlag(true);
    return;
  } else {
    const skeBasisStylingWrapper = getSkeBasisStylingWrapper(rootNode);
    const modalAnchor = document.createElement('div');
    modalAnchor.id = modalAnchorId;
    const parent = skeBasisStylingWrapper ?? shadowRootNode ?? document.body;
    parent.appendChild(modalAnchor);
    setFlag(true);
  }
};

exports.createModalDomPlacement = createModalDomPlacement;

const useEscOnPress = (ref, onClose) => {
  (0, _react.useEffect)(() => {
    const onKeyDown = event => {
      if (ref == null) {
        return;
      }

      if (event.code === 'Escape' && onClose) {
        onClose(ref);
      }
    };

    if (ref) {
      window.addEventListener('keydown', onKeyDown, false);
    }

    return function cleanup() {
      if (window) {
        window.removeEventListener('keydown', onKeyDown);
      }
    };
  }, [ref, onClose]);
};

exports.useEscOnPress = useEscOnPress;